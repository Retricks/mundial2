<html>
  <head>
    <title>Mistrzostwa Świata</title>
  </head>
  <body>
    <h1>Mistrzostwa Świata</h1>
    <h2>Mecze</h2>
    <ul id="matches">
      <!-- Tutaj zostaną wyświetlone mecze -->
    </ul>
    <button id="addMatchButton">Dodaj mecz</button>
    <h2>Statystyki drużyn</h2>
    <table id="stats">
      <tr>
        <th>Drużyna</th>
        <th>RM</th>
        <th>W</th>
        <th>R</th>
        <th>P</th>
        <th>Pkt</th>
      </tr>
      <!-- Tutaj zostaną wyświetlone statystyki -->
    </table>
    <script>
      // Funkcja do odświeżenia listy meczów i statystyk
      function refreshMatchesAndStats() {
        // Pobranie meczów z pamięci przeglądarki
        const matches = JSON.parse(localStorage.getItem("matches")) || [];

        // Wyczyszczenie listy meczów
        document.getElementById("matches").innerHTML = "";

        // Dodanie meczów do listy
        for (const match of matches) {
          const { team1, team2 } = match;
          const matchElement = document.createElement("li");

          // Jeśli wynik meczu jest nieznany, dodaj przycisk "Dodaj wynik"
          if (match.score1 === undefined) {
            matchElement.innerHTML = `${team1} vs ${team2}`;
            const addScoreButton = document.createElement("button");
            addScoreButton.innerText = "Dodaj wynik";
            addScoreButton.onclick = () => {
              // Funkcja do dodawania wyniku meczu
              function addScore(match) {
                const score1 = prompt("Wynik drużyny 1:");
                const score2 = prompt("Wynik drużyny 2:");

                // Sprawdzenie, czy podano poprawne dane
                if (score1 && score2) {
                  // Aktualizacja danych meczu
                  match.score1 = parseInt(score1);
                  match.score2 = parseInt(score2);

                  // Zapisanie aktualizowanych danych w pamięci przeglądarki
                  localStorage.setItem("matches", JSON.stringify(matches));

                  // Odświeżenie listy meczów i statystyk
                  refreshMatchesAndStats();
                }
              }

              // Wywołanie funkcji do dodawania wyniku meczu
              addScore(match);
            };
            matchElement.appendChild(addScoreButton);
          } else {
            // Jeśli wynik meczu jest znany, wyświetl go
            const { score1, score2 } = match;
            matchElement.innerHTML = `${team1} ${score1} : ${score2} ${team2}`;
          }

          // Dodanie elementu z meczem do listy
          document.getElementById("matches").appendChild(matchElement);
        }

        // Wyczyszczenie tabeli z statystykami
        document.getElementById("stats").innerHTML = "";

        // Stworzenie słownika zawierającego statystyki drużyn
        const stats = {};
        for (const match of matches) {
          const { team1, team2, score1, score2 } = match;
          if (!stats[team1]) {
            stats[team1] = { team: team1, played: 0, won: 0, drawn: 0, lost: 0, points: 0 };
          }
          if (!stats[team2]) {
            stats[team2] = { team: team2, played: 0, won: 0, drawn: 0, lost: 0, points: 0 };
          }
          // Jeśli wynik meczu jest znany, dodaj do statystyk
          if (score1 !== undefined) {
            stats[team1].played += 1;
            stats[team2].played += 1;
            if (score1 > score2) {
              stats[team1].won += 1;
              stats[team2].lost += 1;
              stats[team1].points += 3;
            } else if (score1 < score2) {
              stats[team1].lost += 1;
              stats[team2].won += 1;
              stats[team2].points += 3;
            } else {
              stats[team1].drawn += 1;
              stats[team2].drawn += 1;
              stats[team1].points += 1;
              stats[team2].points += 1;
            }
          }
        }

        // Wyświetlenie statystyk drużyn w tabeli
        for (const team of Object.values(stats)) {
          const { team: teamName, played, won, drawn, lost, points } = team;
          const statsRow = document.createElement("tr");
          statsRow.innerHTML = `
            <td>${teamName}</td>
            <td>${played}</td>
            <td>${won}</td>
            <td>${drawn}</td>
            <td>${lost}</td>
            <td>${points}</td>
          `;
          document.getElementById("stats").appendChild(statsRow);
        }
      }

      // Odświeżenie listy meczów i statystyk po załadowaniu strony
      refreshMatchesAndStats();

      // Funkcja do dodawania nowych meczów do listy
      function addMatch() {
        const team1 = prompt("Nazwa drużyny 1:", "");
        const team2 = prompt("Nazwa drużyny 2:", "");


        // Sprawdzenie, czy podano poprawne dane
        if (team1 && team2) {
          // Pobranie meczów z pamięci przeglądarki
          const matches = JSON.parse(localStorage.getItem("matches")) || [];

          // Dodanie nowego meczu do listy
          matches.push({ team1, team });
          // Zapisanie aktualizowanej listy meczów w pamięci przeglądarki
          localStorage.setItem("matches", JSON.stringify(matches));

          // Odświeżenie listy meczów i statystyk
          refreshMatchesAndStats();
        }
      }

      // Dodanie obsługi zdarzenia kliknięcia na przycisk "Dodaj mecz"
      document.getElementById("addMatchButton").onclick = addMatch;
    </script>
  </body>
</html>

