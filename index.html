<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Mecze mistrzostw świata</title>
    <style>
      /* Stylowanie tabel */
      table {
        border-collapse: collapse;
      }
      th, td {
        border: 1px solid black;
        padding: 5px;
      }
      /* Ukrycie przycisku "Dodaj mecz" */
      #addMatchButton {
        display: none;
      }
    </style>
  </head>
  <body>
    <h1>Mecze mistrzostw świata</h1>
    <table id="matches">
      <tr>
        <th>Drużyna 1</th>
        <th>Wynik</th>
        <th>Drużyna 2</th>
        <th>Wynik</th>
        <th>Akcja</th>
      </tr>
    </table>
    <button id="addMatchButton">Dodaj mecz</button>
    <br />
    <h2>Statystyki</h2>
    <table id="stats">
      <tr>
        <th>Drużyna</th>
        <th>RM</th>
        <th>W</th>
        <th>R</th>
        <th>P</th>
        <th>Pkt</th>
      </tr>
    </table>
    <script>
      // Lista meczów
      const matches = [];

  // Funkcja do odświeżania listy meczów i statystyk
  function refreshMatchesAndStats() {
    // Wyczyszczenie listy meczów i statystyk
    document.getElementById("matches").innerHTML = "";
    document.getElementById("stats").innerHTML = "";

    // Wstawienie nagłówków tabeli meczów
    document.getElementById("matches").innerHTML = `
      <tr>
        <th>Drużyna 1</th>
        <th>Wynik</th>
        <th>Drużyna 2</th>
        <th>Wynik</th>
        <th>Akcja</th>
      </tr>
    `;

    // Iteracja po meczach
    for (let i = 0; i < matches.length; i++) {
      // Pobranie danych meczu
      const { team1, team2, score1, score2 } = matches[i];
      // Wstawienie danych meczu do tabeli
      document.getElementById("matches").innerHTML += `
        <tr>
          <td>${team1}</td>
          <td>${score1 !== undefined ? score1 : "---"}</td>
          <td>${team2}</td>
          <td>${score2 !== undefined ? score2 : "---"}</td>
          <td>
            ${score1 === undefined
              ? `<button onclick="showScoreInput(${i})">Dodaj mecz</button>`
              : ""}
          </td>
        </tr>
      `;
    }
  }


        // Obiekt zawierający statystyki drużyn
        const stats = {};
        for (const match of matches) {
          const { team1, team2, score1, score2 } = match;
          // Jeśli drużyna jeszcze nie istnieje w statystykach, dodaj ją
          if (!stats[team1]) {
            stats[team1] = { team: team1, played: 0, won: 0, drawn: 0, lost: 0, points: 0 };
          }
          if (!stats[team2]) {
            stats[team2] = { team: team2, played: 0, won: 0, drawn: 0, lost: 0, points: 0 };
          }
          // Jeśli wynik meczu jest znany, zaktualizuj statystyki drużyn
          if (score1 !== undefined) {
            stats[team1].played += 1;
            stats[team2].played += 1;
            if (score1 > score2) {
              stats[team1].won += 1;
              stats[team2].lost += 1;
              stats[team1].points += 3;
            } else if (score1 < score2) {
              stats[team1].lost += 1;
              stats[team2].won += 1;
              stats[team2].points += 3;
            } else {
              stats[team1].drawn += 1;
              stats[team2].drawn += 1;
              stats[team1].points += 1;
              stats[team2].points += 1;
            }
          }
        }

        // Wyczyszczenie tabeli statystyk
        document.getElementById("stats").innerHTML = `
          <tr>
            <th>Drużyna</th>
            <th>RM</th>
            <th>W</th>
            <th>R</th>
            <th>P</th>
            <th>Pkt</th>
          </tr>
        `;

        // Wypełnienie tabeli statystyk danymi
        for (const team in stats) {
          const { played, won, drawn, lost, points } = stats[team];
          const statsRow = document.createElement("tr");
          statsRow.innerHTML = `
            <td>${team}</td>
            <td>${played}</td>
            <td>${won}</td>
            <td>${drawn}</td>
            <td>${lost}</td>
            <td>${points}</td>
          `;
          document.getElementById("stats").appendChild(statsRow);
        }

        // Pokazanie przycisku "Dodaj mecz"
        document.getElementById("addMatchButton").style.display = "block";
      }

      // Funkcja do wyświetlania pola wprowadzania wyniku meczu
      function showScoreInput(index) {
        // Pobranie wiersza z danymi meczu
        const matchRow = document.getElementById("matches").children[index + 1];
        // Pobranie danych meczu
        const { team1, team2, score1, score2 } = matches[index];
        // Wstawienie pola wprowadzania wyniku meczu i przycisków "Zatwierdź" i "Anuluj"
        matchRow.innerHTML += `
          <td>
            <input type="number" value="${score1 !== undefined ? score1 : ""}" id="score1Input" />
          </td>
          <td>
            <input type="number" value="${score2 !== undefined ? score2 : ""}" id="score2Input" />
          </td>
          <td>
            <button onclick="addScore(${index})">Zatwierdź</button>
            <button onclick="refreshMatchesAndStats()">Anuluj</button>
          </td>
        `;
      }

      // Funkcja do dodawania wyniku meczu
      function addScore(index) {
        // Pobranie wartości z pól wprowadzania wyniku meczu
        const score1 = parseInt(document.getElementById("score1Input").value);
        const score2 = parseInt(document.getElementById("score2Input").value);
        // Zaktualizowanie danych meczu
        matches[index] = {
          ...matches[index],
          score1,
          score2
        };
        // Odświeżenie listy meczów i statystyk
        refreshMatchesAndStats();
      }

      // Funkcja do dodawania meczu
      function addMatch() {
        // Pobranie nazw drużyn z pola wprowadzania
        const team1 = prompt("Podaj nazwę drużyny 1:");
        const team2 = prompt("Podaj nazwę drużyny 2:");
        // Dodanie meczu do listy meczów
        matches.push({
          team1,
          team2
        });
        // Odświeżenie listy meczów i statystyk
        refreshMatchesAndStats();
      }

      // Dodanie obsługi kliknięcia na przycisk "Dodaj mecz"
      document.getElementById("addMatchButton").addEventListener("click", addMatch);

      // Odświeżenie listy meczów i statystyk po załadowaniu strony
      refreshMatchesAndStats();
    </script>
  </body>
</html>
