<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Mecze Mistrzostw Świata</title>
  </head>
  <body>
    <h1>Mecze Mistrzostw Świata</h1>

    <h2>Mecze:</h2>
    <ul id="matches"></ul>

    <h2>Statystyki:</h2>
    <table id="stats">
      <tr>
        <th>Drużyna</th>
        <th>RM</th>
        <th>W</th>
        <th>R</th>
        <th>P</th>
        <th>Pkt</th>
      </tr>
    </table>

    <button id="addMatchButton">Dodaj mecz</button>

    <script>
      // Tablica z meczami
      const matches = [];

      // Funkcja do odświeżania listy meczów i statystyk
      function refreshMatchesAndStats() {
        // Wyczyszczenie listy meczów
        document.getElementById("matches").innerHTML = "";

        // Wypełnienie listy meczów
        for (const match of matches) {
          const { team1, team2, score1, score2 } = match;

          // Stworzenie elementu z meczem
          const matchElement = document.createElement("li");
          if (score1 === undefined) {
            // Jeśli wynik meczu jest nieznany, wyświetl przycisk "Dodaj wynik"
            const addScoreButton = document.createElement("button");
            addScoreButton.style.display = "block";
            addScoreButton.innerHTML = "Dodaj wynik";
            addScoreButton.onclick = () => {
              // Funkcja do dodawania wyniku meczu
              function addScore(match) {
                const score1 = parseInt(
                  prompt(`Wynik drużyny ${team1}:`, "0")
                );
                const score2 = parseInt(
                  prompt(`Wynik drużyny ${team2}:`, "0")
                );

              // Sprawdzenie, czy podano poprawne dane
              if (!isNaN(score1) && !isNaN(score2)) {
                // Dodanie wyniku do meczu
                match.score1 = score1;
                match.score2 = score2;

                // Odświeżenie listy meczów i statystyk
                refreshMatchesAndStats();
              }
            }
            addScore(match);
          }
          matchElement.appendChild(addScoreButton);
        } else {
          // Jeśli wynik meczu jest znany, wyświetl go
          matchElement.innerHTML = `${team1} ${score1} - ${score2} ${team2}`;
        }
        document.getElementById("matches").appendChild(matchElement);
      }

      // Funkcja do odświeżania statystyk drużyn
      function refreshStats() {
        // Wyczyszczenie tabeli statystyk
        document.getElementById("stats").innerHTML = `
          <tr>
            <th>Drużyna</th>
            <th>RM</th>
            <th>W</th>
            <th>R</th>
            <th>P</th>
            <th>Pkt</th>
          </tr>
        `;

        // Tablica z statystykami drużyn
        const stats = {};

        // Wypełnienie tabeli statystyk
        for (const match of matches) {
          const { team1, team2, score1, score2 } = match;
          if (!stats[team1]) {
            stats[team1] = { team: team1, played: 0, won: 0, drawn: 0, lost: 0, points: 0 };
          }
          if (!stats[team2]) {
            stats[team2] = { team: team2, played: 0, won: 0, drawn: 0, lost: 0, points: 0 };
          }
          // Jeśli wynik meczu jest znany, dodaj do statystyk
          if (score1 !== undefined) {
            stats[team1].played += 1;
            stats[team2].played += 1;
            if (score1 > score2) {
              stats[team1].won += 1;
              stats[team2].lost += 1;
              stats[team1].points += 3;
            } else if (score1 < score2) {
              stats[team1].lost += 1;
              stats[team2].won += 1;
              stats[team2].points += 3;
            } else {
              stats[team1].drawn += 1;
              stats[team2].drawn += 1;
              stats[team1].points += 1;
              stats[team2].points += 1;
            }
          }
        }
        // Wypełnienie tabeli statystyk danymi
        for (const stat of Object.values(stats)) {
          const { team, played, won, drawn, lost, points } = stat;
          const statRow = document.createElement("tr");
          statRow.innerHTML = `
            <td>${team}</td>
            <td>${played}</td>
            <td>${won}</td>
            <td>${drawn}</td>
            <td>${lost}</td>
            <td>${points}</td>
          `;
          document.getElementById("stats").appendChild(statRow);
        }
      }

      // Funkcja do dodawania meczu
      function addMatch() {
        const team1 = prompt("Nazwa drużyny 1:", "");
        const team2 = prompt("Nazwa drużyny 2:", "");

        // Sprawdzenie, czy podano nazwy drużyn
        if (team1 && team2) {
          // Dodanie meczu do tablicy meczów
          matches.push({ team1, team2 });

          // Odświeżenie listy meczów i statystyk
          refreshMatchesAndStats();
          refreshStats();
        }
      }

      // Dodanie obsługi zdarzenia kliknięcia na przycisk "Dodaj mecz"
      document.getElementById("addMatchButton").onclick = addMatch;
    </script>
  </body>
</html>
